#include<stdio.h>

int mutex=1;
int full=0;
int empty=3;
int x=0;

int wait(int s)
{
while(s<=0);
return(--s);
}

int signal(int s)
{
return(++s);
}

void producer()
{
empty=wait(empty);
mutex=wait(mutex);
x++;
printf("\nProducer produces item number:%d",x);
mutex=signal(mutex);
full=signal(full);
}

void consumer()
{
full=wait(full);
mutex=wait(mutex);
printf("\nConsumer consumes item number:%d",x);
x--;
mutex=signal(mutex);
empty=signal(empty);
}

int main()
{
int ch=0,t=0;
do
{
printf("\nMenu:");
printf("\n1.Producer");
printf("\n2.Consumer");
printf("\n3.Exit");
scanf("%d",&ch);

switch(ch)
{
case 1:
if(mutex==1 && empty!=0)
producer();
else
printf("\nBuffer is full");
break;

case 2:
if(mutex==1 && full!=0)
consumer();
else
printf("\nBuffer is empty");
break;

case 3:
t=1;
break;

default:
printf("\nEnter valid choice ");
break;
}
}
while(t!=1);

return 0;
}